<!DOCTYPE HTML>
<!--
	Dimension by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Scenario Week 6 - Upload your file</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="shortcut icon" type="image/png" href="favicon.png"/>
		<link rel="stylesheet" href="assets/css/main.css" />
 		<link rel="stylesheet" type="text/css" href="jsxgraph.css" />
 		<script type="text/javascript" src="jsxgraphcore.js"></script>
		<!--[if lte IE 9]><link rel="stylesheet" href="assets/css/ie9.css" /><![endif]-->
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body>

		<!-- Wrapper -->

			<div id="wrapper">

				<!-- Header -->
					<header id="header">
						<div class="logo" style="padding-left:6px">
							<span class="icon fa-pencil-square-o"></span>
						</div>
						<div class="content">
							<div class="inner">
								<p align="center"><a href="input.rar"><img src="logo2.png" width="40%" height="40%"></a></p>
								<h1>Select a file to upload</h1>


								<form action="myform.cgi"> 
									<select id="timeSelect">
										<option value"0" selected disabled>Select the waiting time between line plotting</option>
										<option value="0">0 secs</option>
										<option value="200">0.2 secs</option>
										<option value="500">0.5 secs</option>
										<option value="800">0.8 secs</option>
										<option value="1000">1 sec</option>
										<option value="2000">2 secs</option>
										<option value="3000">3 secs</option>
										<option value="5000">5 secs</option>
										<option value="10000">10 secs</option>
									</select>
									<br>
									<input style="display:none;" type="file" name="fileupload" value="fileupload" id="fileupload"> 
									<!--<label for="fileupload"></label> -->
									<input onclick="$('#fileupload').click();" type="button" style="font-weight:bold" value="Upload"> </form>

							</div>
						</div>
						<div id="jxgbox" class="jxgbox" style="overflow:hidden;position:relative;width:600px;height:600px;"></div>
						<p align="center"><img id="monkey" src="monkey.png"></p>

					</header>

				

				<!-- Footer -->
					<footer id="footer">
						<p id ="copy-right" class="copyright">&copy; Scenario Week 6 - Group AD. Design: <a href="https://html5up.net">HTML5 UP</a>.</p>
					</footer>

			</div>

		<!-- BG -->
			<div id="bg"></div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/skel.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
			<!--<script type="text/JavaScript" src="jsDraw2D.js"></script>-->


<script type="text/javascript">
	$("#jxgbox").hide();
	$("#fileupload").on('change',function(){$("#jxgbox").slideDown(1000);setTimeout(function() {window.scrollTo(0,document.body.scrollHeight);}, 760);
})
	var board = JXG.JSXGraph.initBoard('jxgbox', {boundingbox:[-5,5,5,-5], keepaspectratio: true, axis:false});
	   
	var timeToSleep = 0;
	
	$("#timeSelect").change(function(){
		timeToSleep = $(this).val();
	});

	function readSingleFile(evt) {
    //Retrieve the first (and only!) File from the FileList object
    var f = evt.target.files[0]; 

    if (f) {
      var r = new FileReader();
      r.onload = function(e) { 
	      var contents = e.target.result;
        
        plotInput(contents);
      }
      r.readAsText(f);
      
    } else { 
      alert("Failed to load file");
    }
  }

  function plotInput(result)
  {

      var lines = result.split('\n');
      var rn = parseInt(lines[0], 10);
      var robotsArray = new Array();    
	
      

      var actualLine = 1;
      var robots = lines[actualLine].split(" ");
      //console.log(robots);
	  for(var i = 0; i < rn; i++){
	  		var x = parseFloat(robots[i * 2]);
	  		var y = parseFloat(robots[i * 2 + 1]);
			board.create('point',[x, y],{size:8,face:'<>',withLabel: 0, color:'#00008B'});
	  }


	  actualLine++;

	  var pn = parseInt(lines[actualLine], 10);
	  for(var i = 0; i < pn; i++)
	  {
	  		var polygonArray = new Array();
	  		actualLine++;
	  		var ppn = parseInt(lines[actualLine], 10);
	  		actualLine++;
	  		var pPoints = lines[actualLine].split(" ");
	  		for(var j = 0; j < ppn; j++)
	  		{
	  			var x = parseFloat(pPoints[j * 2]);
	  			var y = parseFloat(pPoints[j * 2 + 1]);
				polygonArray.push([x,y]);
	  		}
	  		board.create('polygon',polygonArray,{fillColor: get_random_color(), withLabel: 0});

	  }

	  actualLine++;
	  var rnn = parseInt(lines[actualLine], 10);
	  console.log(rnn);
	  for(var j = 0; j <= rnn; j++)
	  {
	  	setTimeout(function(){
	  		var solArray = new Array();  
	  		actualLine++;

	  		var sn = parseInt(lines[actualLine], 10);
	  		//console.log(sn);
	  		actualLine++;
	  		if(lines[actualLine] != null){
	  			var sol = lines[actualLine].split(" ");
	  			for(var i = 0; i <= sn; i++){
	  				var x = parseFloat(sol[i * 2]);
	  				var y = parseFloat(sol[i * 2 + 1]);
					solArray.push([x,y]);
	  			}
	  			plotRoad(solArray);
	  		}
	  	}, timeToSleep * (j + 1));
	  	
	  	//setTimeout( plotRoad(solArray), 100);
	  }
  }


  document.getElementById('fileupload').addEventListener('change', readSingleFile, false);

 

  	

    function plotRoad(points){
    	console.log(points);
    	var colorrrr = get_random_color();
    	for(var i = 0; i < points.length - 1; i++){

    		board.create('line',[board.create('point',[points[i][0],points[i][1]]),board.create('point',[points[i+1][0],points[i+1][1]])],{straightFirst:false, straightLast:false, strokeWidth:2, strokeColor:colorrrr, withLabel: 0});
    	}
    }
function get_random_color() 
{
    var color = "";
    for(var i = 0; i < 3; i++) {
        var sub = Math.floor(Math.random() * 256).toString(16);
        color += (sub.length == 1 ? "0" + sub : sub);
    }
    if(color == "009CDE" || color == "FF0000"){
    	get_random_color();
    }
    else return "#" + color;
}
</script>
<script>
$("#monkey").hide();
$("#copy-right").on('mouseover', function (){$("#monkey").slideDown();});
$("#monkey").on('mouseleave', function (){$("#monkey").slideUp();});
</script>
	</body>
</html>
